<!--
  Disclaimer!
  The creator of Roofpig, aka the alg visualizer, is not me 
  I just integrated Roofpig with anki, so all the credit 
  should go to the creator of Roofpig Larspetrus.
  Visit their GitHub page to view the original visualizer and info on how to customize
  https://github.com/larspetrus/Roofpig
-->

{{Name}}

<br />

<div id="image">{{Image}}</div>
<div id="algorithm" , style="display: none">{{Algorithm}}</div>
<div id="container"></div>

<script>
  // declaring functions
  function reverseAlg(algorithm) {
    var splittedAlg = algorithm.trim().split(" ");
    var reverseAlg = [];
    var element;

    for (i = 0; i < splittedAlg.length; i++) {
      element = splittedAlg[i];
      element = element.trim();
      if (element.at(-1) == "'") {
        // removing ' symbol if exists
        element = element.replace("'", "");
      } else if (element.at(-1) != "2") {
        // adding ' symbol if not present already
        element += "'";
      }

      reverseAlg.push(element);
    }

    // reversing the alg and joining it into a string
    reverseAlg = reverseAlg.reverse().join(" ");
    return reverseAlg;
  }

  // displaying visualizer if the image field is empty
  if (document.getElementById("image").innerHTML.trim() == "") {
    // reading algorithm field
    var algorithm = document.getElementById("algorithm").innerText;
    var setupMoves = algorithm;

    // creating reverse algorithm if the algorithm is not in commutator notation
    if (!/[^\|]*[\[\]]/.test(algorithm)) {
      setupMoves = reverseAlg(algorithm);
    }

    // reading background color
    var backgroundColor = window.getComputedStyle(
      document.querySelector("body")
    )["background-color"];

    // loading visualizer
    var container = document.getElementById("container");
    var iframe = document.createElement("iframe");

    iframe.src =
      // edit url below to custumize the cube
      // add settings between "?config=" and "alg=" to customize the visualizer
      // example "https://ankube-40718.web.app/?config=colors=U:w L:o F:g R:r B:b D:y|setupmoves="
      //                                              /          added text           \
      // note that you have to add | symbol between each settings
      // see https://github.com/larspetrus/Roofpig for every setting available

      "https://ankube-40718.web.app/?config=setupmoves=" +
      setupMoves +
      "&bgcolor=" +
      backgroundColor;

    iframe.style.width = "250px";
    iframe.style.height = "250px";
    iframe.scrolling = "no";
    iframe.frameBorder = 0;
    container.appendChild(iframe);
  }
</script>
